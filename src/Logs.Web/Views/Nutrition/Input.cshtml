@model Logs.Web.Models.Nutrition.InputViewModel

@{
    ViewBag.Title = "Input";
}
<link rel="stylesheet" href="/Content/bootstrap-datetimepicker.css" />

<div class="row">
    <div class="col-sm-3"></div>
    <div class="col-sm-6">
        @Html.DisplayNameFor(m => m.Date)
        <input class="form-control" id="datetimepicker" />
    </div>
</div>

<hr />
<div class="row">
    <div class="col-sm-3"></div>
    <div class="col-sm-6">
        <ul class="list-inline intro-social-buttons">
            <li>
                @using (Ajax.BeginForm("Load", "Nutrition",
          new AjaxOptions { HttpMethod = "POST", InsertionMode = InsertionMode.Replace, UpdateTargetId = "nutrition" },
          new { @class = "form-horizontal form col-md-12 center-block", role = "form", id = "nutrition-form" }))
                {
                    @Html.AntiForgeryToken()
                    <input type="hidden" id="nutrition-model-date" name="date" />
                    <input type="submit" class="btn btn-default btn-lg" value="Nutrition" />
                }
            </li>
            <li>

                @using (Ajax.BeginForm("Load", new { controller = "Measurement" },
      new AjaxOptions { HttpMethod = "POST", InsertionMode = InsertionMode.Replace, UpdateTargetId = "measurements" },
      new { @class = "form-horizontal form col-md-12 center-block", role = "form", id = "measurement-form" }))
                {
                    @Html.AntiForgeryToken()
                    <input type="hidden" id="measurements-model-date" name="date" />
                    <input type="submit" class="btn btn-default btn-lg" value="Measurements" />
                }
            </li>
        </ul>
    </div>
</div>





<div>
    <div id="nutrition">
    </div>

    <div id="measurements">
    </div>
</div>
@section scripts{
    @Scripts.Render("~/bundles/jquery-unobtrusive")
    <script type="text/javascript" src="/scripts/moment.min.js"></script>
    <script type="text/javascript" src="/scripts/bootstrap-datetimepicker.js"></script>

    <script type="text/javascript">
        $(function () {
            $('#datetimepicker').datetimepicker({
                format: 'DD/MM/YYYY'
            });

            $('#nutrition-form').hide();
            $('#measurement-form').hide();

            $('#datetimepicker').on("dp.change", function (e) {
                var date = $('#datetimepicker').val();
                var parts = date.split('/');

                var datetime = new Date(parts[2], (+parts[1]) - 1, (+parts[0]) + 1).toISOString();

                $('#nutrition-form').show();
                $('#measurement-form').show();

                $('#nutrition-model-date').val(datetime);
                $('#measurements-model-date').val(datetime);
            });

            $('#nutrition-form').submit(() => {
                $('#measurements').hide();
                $('#nutrition').show();
            });

            $('#measurement-form').submit(() => {
                $('#nutrition').hide();
                $('#measurements').show();
            });
        });
    </script>
}
